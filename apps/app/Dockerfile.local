# apps/app/Dockerfile.local
# syntax=docker/dockerfile:1.7
FROM node:20-alpine
WORKDIR /repo

ENV COREPACK_ENABLE_DOWNLOADS=1
RUN corepack enable && corepack prepare pnpm@10.15.0 --activate

ENV PNPM_STORE_DIR=/pnpm
RUN mkdir -p /pnpm && chmod -R 777 /pnpm
RUN printf "store-dir=/pnpm\nshared-workspace-lockfile=true\n" > /etc/pnpmrc

CMD ["sh", "-lc", "\
  pnpm -C apps/app install && \
  pnpm -C apps/app dev --host 0.0.0.0 --port 5173 \
"]
