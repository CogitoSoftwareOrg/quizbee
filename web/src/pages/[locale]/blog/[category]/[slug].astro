---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";

import Root from "@/layouts/Root.astro";

export const getStaticPaths = async () => {
  const posts = await getCollection("blog");
  return posts.map((post: any) => {
    return {
      params: {
        locale: post.data.locale,
        slug: post.data.slug,
        category: post.data.category,
      },
      props: {
        meta: post.data.meta,
        content: post.data.contentHtml,
        article: post.data.article,
      },
    };
  });
};

const { meta, content, article } = Astro.props;
---

<Root
  title={meta.title}
  description={meta.description}
  image={meta.image}
  active="blog"
>
  <article class="mx-auto max-w-3xl py-12">
    {
      article.coverUrl && (
        <Image
          src={article.coverUrl}
          alt={meta.title}
          class="mb-6 rounded-xl"
          width={1000}
          height={1000}
        />
      )
    }
    <h1 class="text-3xl font-bold mb-2">{meta.title}</h1>
    <p class="text-sm text-muted-foreground mb-6">
      {article.datePublished} Â· {article.readingTimeMin} min read
    </p>

    <div class="prose prose-neutral max-w-none" set:html={content} />
  </article>
</Root>
